{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Test Suite Schema",
  "description": "Schema for YAML test files with conversation flows",
  "type": "object",
  "properties": {
    "description": {
      "type": "string",
      "description": "Description of what this test suite covers"
    },
    "grader": {
      "type": "string",
      "description": "Grading method or strategy for evaluating test outcomes"
    },
    "testcases": {
      "type": "array",
      "description": "Array of test cases",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the test case"
          },
          "outcome": {
            "type": "string",
            "description": "Description of what the AI should accomplish in this test"
          },
          "note": {
            "type": "string",
            "description": "Optional note or additional context for the test case"
          },
          "validator": {
            "type": "string",
            "description": "Optional path to validator script for building/validating generated code"
          },
          "messages": {
            "type": "array",
            "description": "Conversation messages",
            "minItems": 1,
            "items": {
              "type": "object",
              "properties": {
                "role": {
                  "type": "string",
                  "enum": ["system", "user", "assistant"]
                },
                "content": {
                  "oneOf": [
                    {
                      "type": "string",
                      "description": "Simple text content"
                    },
                    {
                      "type": "array",
                      "description": "Mixed content items",
                      "items": {
                        "type": "object",
                        "properties": {
                          "type": {
                            "type": "string",
                            "enum": ["text", "file"]
                          },
                          "value": {
                            "type": "string"
                          }
                        },
                        "required": ["type", "value"],
                        "additionalProperties": false
                      }
                    }
                  ]
                }
              },
              "required": ["role", "content"],
              "additionalProperties": false
            }
          }
        },
        "required": ["id", "outcome", "messages"],
        "additionalProperties": false
      }
    }
  },
  "required": ["testcases"],
  "additionalProperties": false
}
